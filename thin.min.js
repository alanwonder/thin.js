function poplayer(t){var e=document.createElement("popmask");e.style.zIndex=1e3;var a,i=document.createElement("popdialog");switch(typeof t.width){case"string":i.style.width=t.width;break;case"number":i.style.width=t.width+"px"}if(void 0!==t.width&&(i.style.width=t.width),e.appendChild(i),void 0!==t.header){a=document.createElement("popheader"),$(a).html(t.header);var n=document.createElement("closeicon");n.innerText="âœ•",n.onclick=function(){void 0!==t.onclose&&t.onclose(),$(e).remove()},n.onmouseover=function(){this.style.filter="alpha(opacity=80)",this.style.opacity=".8"},n.onmouseout=function(){this.style.filter="alpha(opacity=50)",this.style.opacity=".5"},a.appendChild(n),i.appendChild(a)}var o=document.createElement("popbody");switch(typeof t.height){case"string":o.style.height=t.height,o.style.overflowY="scroll";break;case"number":o.style.height=t.height+"px",o.style.overflowY="scroll";break;default:o.style.maxHeight="600px",o.style.overflowY="scroll"}i.appendChild(o),document.body.appendChild(e),void 0!==t.render?t.render({container:o}):$(o).render({data:t.data,template:t.template}),popDrag(a,i)}$(function(){$(document).on("click","tab-nav",function(){$("tab-nav",this.parentElement).removeClass("active"),$(this).addClass("active");var t=this.getAttribute("function");null===t||"function"==typeof window[t]&&window[t]();var e=this.getAttribute("view");if(null!==e){var a=$(this).parents("multiview:first");$("view",a).removeClass("active"),$("view#"+e,a).addClass("active")}})}),$.fn.extend({render:function(t){function e(t){if(Array.isArray(t.d))for(var e=0;e<t.d.length;e++)a({c:t.c,t:t.t,d:t.d[e]});else a({c:t.c,t:t.t,d:t.d})}function a(t){if(Array.isArray(t.t))for(var e=0;e<t.t.length;e++)i({t:t.t[e],c:t.c,d:t.d});else i({t:t.t,c:t.c,d:t.d})}function i(t){if("string"==typeof t.t){var e=o({t:t.t,c:t.c}),a=document.createDocumentFragment();$(a).append(e),t.c.appendChild(a)}else if("[object Object]"===Object.prototype.toString.call(t.t))n({c:t.c,t:t.t,d:t.d});else if("function"==typeof t.t){var i=r(t.c);t.t({container:t.c,data:i?i.data_of_thin:void 0})}else console.log(Object.prototype.toString.call(t.t))}function n(t){if(void 0!==t.t.datapath&&void 0===t.d){var i=c({container:t.c,path:t.t.datapath});null!==i&&e({c:t.c,d:i,t:t.t})}else{if(void 0!==t.t.if)switch(typeof t.t.if){case"function":t.t.if({container:t.c,data:t.t.data?t.t.data:t.data})?a({c:t.c,t:t.t.then}):t.t.else&&a({c:t.c,t:t.t.else});break;default:t.t.if?a({c:t.c,t:t.t.then}):t.t.else&&a({c:t.c,t:t.t.else})}else if(void 0!==t.t.switch){let e="function"==typeof t.t.switch?t.t.switch({container:t.c,data:t.t.data?t.t.data:t.data}):o({t:t.t.switch,c:t.c});void 0===t.t.case||(void 0!==t.t.case[e]?a({c:t.c,t:t.t.case[e]}):void 0!==t.t.case.default&&a({c:t.c,t:t.t.case.default}))}else n();function n(){var e=document.createElement(t.t.e?t.t.e:"div");if($(t.c).append(e),t.t.data?e.data_of_thin=t.t.data:void 0!==t.d&&(e.data_of_thin=t.d),void 0!==t.t.name&&e.setAttribute("name",t.t.name),void 0!==t.t.id&&e.setAttribute("id",t.t.id),void 0!==t.t.class&&e.setAttribute("class",t.t.class),t.t.width&&e.style.setProperty("width","number"==typeof t.t.width?t.t.width+"px":t.t.width),t.t.height&&e.style.setProperty("height","number"==typeof t.t.height?t.t.height+"px":t.t.height),void 0!==t.t.options)if("[object Array]"===Object.prototype.toString.call(t.t.options))for(var i=0;i<t.t.options.length;i++)e.options.add(new Option(t.t.options[i]));else if("[object Object]"===Object.prototype.toString.call(t.t.options));else if("[object String]"===Object.prototype.toString.call(t.t.options))for(var n=t.t.options.split(","),c=0;c<n.length;c++)e.options.add(new Option(n[c]));if(void 0!==t.t.selected){var l=o({t:t.t.selected,c:e});$(e).val(l)}if(void 0!==t.t.value){let a=o({t:t.t.value,c:e});$(e).val(a)}if(t.t.bind){var s=r(e);if(s){var d=s.data_of_thin;let a=t.t.bind.split("/");for(var f=0;f<a.length-1;f++)d=d[a[f]];$(e).val(d[a[a.length-1]]),$(e).on("change",t=>{console.log(t);for(var i=s.data_of_thin,n=0;n<a.length-1;n++)i[a[n]]||(i[a[n]]={}),i=i[a[n]];i[a[a.length-1]]=$(e).val(),console.log(s.data_of_thin)})}}switch(void 0!==t.t.click&&(e.onclick=function(){var e=r(this),a={};null!==e&&($("input",e).each(function(t,e){if(void 0!==this.attributes.name){var i=this.attributes.name.value;a[i]=$(this).val()}}),$("select",e).each(function(t,e){if(void 0!==this.attributes.name){var i=this.attributes.name.value;a[i]=$(this).val()}}),$("textarea",e).each(function(t,e){if(void 0!==this.attributes.name){var i=this.attributes.name.value;a[i]=$(this).val()}})),t.t.click({sender:this,org_data:e.data_of_thin,new_data:a})}),void 0!==t.t.event&&Object.keys(t.t.event).forEach(function(a){$(e).on(a,function(e){var a=r(this),i=new Object;$("input",a).each(function(t,e){if(void 0!==this.attributes.name){var a=this.attributes.name.value;i[a]=$(this).val()}}),$("select",a).each(function(t,e){if(void 0!==this.attributes.name){var a=this.attributes.name.value;i[a]=$(this).val()}}),$("textarea",a).each(function(t,e){if(void 0!==this.attributes.name){var a=this.attributes.name.value;i[a]=$(this).val()}});var n=e.type;t.t.event[n]({sender:this,type:n,event:e,org_data:a.data_of_thin,new_data:i})})}),t.t.e){case"fieldset":if(t.t.title){let a=document.createElement("legend");a.innerText=t.t.title,e.appendChild(a)}break;case"field":case"f1":case"f2":case"f3":if(void 0!==t.t.title){let a=document.createElement("label");a.innerText=t.t.title,e.appendChild(a)}}void 0!==t.t.t&&a({c:e,t:t.t.t}),void 0!==t.t.a&&Object.keys(t.t.a).forEach(function(a){if("function"==typeof t.t.a[a]){var i=r(e);e.setAttribute(a,t.t.a[a]({container:e,data:i.data_of_thin}))}else e.setAttribute(a,o({t:t.t.a[a],c:e}))}),void 0!==t.t.style&&Object.keys(t.t.style).forEach(function(a){if("function"==typeof t.t.style[a]){var i=r(e);e.style.setProperty(a,t.t.style[a]({container:e,data:i.data_of_thin}))}else e.style.setProperty(a,o({t:t.t.style[a],c:e}))})}}}function o(t){var e=t.t,a=/\[\[[a-zA-Z0-9\-\.\/_]*\]\]/gi,i="string"!=typeof e?e:e.replace(a,function(e){for(var a=e.replace("[[","").replace("]]",""),i=a.split("/"),n=r(t.c),o=0;o<i.length;o++)if(".."===i[o]){if(!l(n))return e;n=r(n.parentNode)}else{if(l(n)){if(void 0===n.data_of_thin)return e;n=n.data_of_thin}if(null===n)return null;n=n[i[o]]}return null==n?"":n});return i}function r(t){for(;!t.hasOwnProperty("data_of_thin");){if(null===t.parentNode)return null;t=t.parentNode}return t}function c(t){for(var e=t.path.split("/"),a=r(t.container),i=0;i<e.length;i++)if(".."===e[i]){if(!l(a))return null;a=r(a.parentNode)}else{if(l(a)){if(void 0===a.data_of_thin)return null;a=a.data_of_thin}if(null===a)return null;if(!(e[i]in a))return null;a=a[e[i]]}return a}function l(t){return!(!t||"undefined"==typeof window||t!==window&&!t.nodeType)}void 0===t.data&&(t.data={}),Array.isArray(t.template)?e({c:this[0],t:t.template,d:t.data}):Array.isArray(t.data)?e({c:this[0],t:t.template,d:t.data}):"[object Object]"===Object.prototype.toString.call(t.template)?e({c:this[0],t:t.template,d:t.data}):(this[0].data_of_thin=t.data,e({c:this[0],t:t.template}))}}),poplayer.close=function(t){console.log({pos:"poplayer.close",element:t})};var popDrag=function(t,e,a){var i={left:0,top:0,currentX:0,currentY:0,flag:!1,resetPosition:function(){var t=$(e).css("left"),a=$(e).css("top");"auto"!==t&&(this.left=t),"auto"!==a&&(this.top=a)}};i.resetPosition(),t.onmousedown=function(e){i.flag=!0,e||(e=window.event,t.onselectstart=function(){return!1});var a=e;i.currentX=a.clientX,i.currentY=a.clientY},document.onmouseup=function(){i.flag=!1,i.resetPosition()},document.onmousemove=function(t){var n=t||window.event;if(i.flag){var o=n.clientX,r=n.clientY,c=o-i.currentX,l=r-i.currentY;return e.style.left=parseInt(i.left)+c+"px",e.style.top=parseInt(i.top)+l+"px","function"==typeof a&&a((parseInt(i.left)||0)+c,(parseInt(i.top)||0)+l),t.preventDefault&&t.preventDefault(),!1}}};